<script>
  // チェックボックスアイテムIDリスト取得
  function getCheckItemIDList() {
    return ["sheetList",
            "campList",
            "mngCampList",
            "fistAidList",
            "cookList",
            "citizenList",
            "pioneerList",
            "leaderList",
            "hikeList",
            "songList",
            "commList",
            "measList",
            "obsrvList"
            ];
  }

  // ページ読み込み時処理
  window.addEventListener("load", (event) => {
    var idlist = getCheckItemIDList();
    idlist.forEach(id => {
      var elem = document.getElementById(id);
      elem.style.display = "none";
    });;
  });
  
  // 表示・非表示スイッチ関数
  function switchListDisplay(titleStr, titleID, listID) {
    var elemTitle = document.getElementById(titleID);
    var elemList = document.getElementById(listID);
    
    if (elemList.style.display == "block") {
      elemList.style.display = "none";
      elemTitle.innerHTML = "▶"+titleStr;
    } else {
      elemList.style.display = "block";
      elemTitle.innerHTML = "▼"+titleStr;
    }
  }
  
  // 大項目クリック処理
  function clickTitle(titleStr, titleID, listID) {
    switchListDisplay(titleStr, titleID, listID);
  }
  
  // 「完了」ボタンクリック
  function clickApply() {
    var targetList = getTargetSheetList();
    var data = getCheckDataList();
    google.script.run.SetLog(data);
  }
  
  // 「キャンセル」ボタンクリック
  function clickCancel() {
    google.script.host.close();
  }
  
  // 対象者リスト
  function getTargetSheetList() {
    var sheetCheckList = document.getElementById("sheetList").getElementsByTagName("input");
    sheetCheckList = Array.from(sheetCheckList);
    
    var targetList = [];
    sheetCheckList.forEach(elem => {
      if (elem.checked) {
        targetList.push(elem.name);
      }
    });
    return targetList;
  }
  
  // チェックしたデータを取得
  function getCheckDataList() {
    var idList = getCheckItemIDList();
    idList.shift();
    var data = {};
    
    idList.forEach(id => {
      var tempCheckList = [];
      var tempList = Array.from(document.getElementById(id).getElementsByTagName("input"));
      tempList.forEach(elem => {
        tempCheckList.push(elem.checked);
      });
      data[id] = tempCheckList;
    });
    return data;
  }
</script>
